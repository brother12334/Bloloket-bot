async function joinBots() {
    const gameId = document.getElementById("gcode").value.trim();
    const baseUsername = document.getElementById("gname").value.trim();
    const numJoins = parseInt(document.getElementById("numJoins").value, 10);
    const selectedSkin = document.getElementById("skinSelect").value;

    if (!gameId || gameId.length !== 7) return log("‚ùå Invalid Game Code!");
    if (!baseUsername) return log("‚ùå Please enter a bot name prefix.");
    if (isNaN(numJoins) || numJoins <= 0 || numJoins > 100) return log("‚ùå Enter a valid bot count (1-100).");

    log(`üéÆ Sending ${numJoins} bots to Game ${gameId}...`);

    try {
        // Use correct key names ("gameId" and "name")
        const response = await fetch("https://shard-uttermost-crystal.glitch.me/proxy/https://blooketbot.glitch.me/join", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "User-Agent": getRandomUserAgent(),
                "Connection": "keep-alive"
            },
            body: JSON.stringify({
                gameId: gameId,
                name: `${baseUsername}1`
            })
        });

        const data = await response.json();
        console.log("Server Response:", data); // Debug response
        if (!data.success) throw new Error(data.msg || "Unknown error");

        await initFirebase(data.fbShardURL, data.fbToken);

        // Parallel execution with slight delay to avoid rate limit
        await Promise.all(
            Array.from({ length: numJoins }, (_, i) =>
                new Promise((resolve) => {
                    setTimeout(async () => {
                        const updates = {};
                        updates[`${gameId}/c/${baseUsername}${i + 1}`] = {
                            b: selectedSkin,
                            rt: true
                        };
                        await update(ref(db), updates);
                        log(`‚úÖ Bot ${i + 1} joined successfully!`);
                        resolve();
                    }, Math.random() * 100 + 20); // 20ms to 120ms delay
                })
            )
        );

        log(`‚úÖ All ${numJoins} bots joined successfully!`);
    } catch (error) {
        log(`‚ùå Error: ${error.message}`);
    }
}
